/**
 * Project: pulldown
 * Description: jQuery drop-down loading plugin
 * Author: A.J <804644245@qq.com>
 * Copyright: http://www.catfish-cms.com All rights reserved.
 * Version: 1.2.0
 */
!function(t){t.fn.pulldown=function(e){e=e||{};var n=t.extend(t.fn.pulldown.defaults,e);return this.each(function(){t.fn.pulldown.getcontent(t(this),n)})},t.fn.pulldown.getcontent=function(e,n){var o=!0,a=n.startPage,l=0;e.bind("scroll",function(){var f=e.scrollTop();if(f+n.offset>=t(document).height()-e.height()&&o&&l<f){o=!1,null!=n.beforeLoad&&n.beforeLoad();var r={},u=location.search;if(""!=u){var d=(u=u.substr(1)).split("&");t.each(d,function(t,e){var n=e.split("=");r[n[0]]=n[1]})}r[n.sign]=1,r[n.page]=a,n.contentData=t.extend(n.contentData,r),t.ajax({method:n.method,url:n.getUrl,data:n.contentData}).done(function(e){a++;var l=!0;if("string"==typeof e)if(""==e)l=!1;else try{var f=JSON.parse(e);"object"==typeof f&&((t.isEmptyObject(f)||""==f[n.judge]||0==f[n.judge])&&(l=!1),e=f)}catch(t){}else"object"!=typeof e||!t.isEmptyObject(e)&&""!=e[n.judge]&&0!=e[n.judge]||(l=!1);null!=n.afterLoad&&n.afterLoad(e),o=l})}l=f})},t.fn.pulldown.defaults={getUrl:"",contentData:{},beforeLoad:null,afterLoad:null,offset:20,sign:"pulldown",page:"page",startPage:2,judge:"next",method:"GET"}}(jQuery);